# æ£€ç´¢æŠ€èƒ½è®¾è®¡

## æŠ€èƒ½åç§°
`obsidian-memory-retriever`

## æ ¸å¿ƒåŠŸèƒ½
åœ¨ Obsidian Bases è®°å¿†ç³»ç»Ÿä¸­æ™ºèƒ½æ£€ç´¢ä¿¡æ¯ï¼Œæ”¯æŒå…³é”®è¯ã€è¯­ä¹‰å’Œæ··åˆæœç´¢ã€‚

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1: å…³é”®è¯æœç´¢
**ç”¨æˆ·è¯´**ï¼š"æœç´¢ PostgreSQL ç›¸å…³çš„è®°å½•"
**æŠ€èƒ½åŠ¨ä½œ**:
1. æå–å…³é”®è¯ï¼š"PostgreSQL"
2. åœ¨æ ‡é¢˜ã€å†…å®¹ã€æ ‡ç­¾ä¸­åŒ¹é…
3. è¿”å›ç²¾ç¡®åŒ¹é…ç»“æœ

### åœºæ™¯ 2: è¯­ä¹‰æœç´¢
**ç”¨æˆ·è¯´**ï¼š"æˆ‘ä»¬ä¹‹å‰è®¨è®ºè¿‡æ•°æ®åº“é€‰æ‹©å—ï¼Ÿ"
**æŠ€èƒ½åŠ¨ä½œ**:
1. ç†è§£æ„å›¾ï¼šæŸ¥æ‰¾å…³äºæ•°æ®åº“çš„è®¨è®ºå’Œå†³ç­–
2. ä½¿ç”¨è¯­ä¹‰ç›¸ä¼¼åº¦åŒ¹é…
3. è¿”å›ç›¸å…³æ¦‚å¿µï¼Œå³ä½¿å…³é”®è¯ä¸å®Œå…¨åŒ¹é…

### åœºæ™¯ 3: æ··åˆæœç´¢
**ç”¨æˆ·è¯´**ï¼š"æ‰¾åˆ°æˆ‘ä»¬åšè¿‡çš„æŠ€æœ¯å†³ç­–ï¼Œç‰¹åˆ«æ˜¯å…³äº API çš„"
**æŠ€èƒ½åŠ¨ä½œ**:
1. æå–å…³é”®è¯ï¼š"æŠ€æœ¯å†³ç­–", "API"
2. æ‰§è¡Œæ··åˆæœç´¢ï¼š
   - å…³é”®è¯åŒ¹é…ï¼š"æŠ€æœ¯å†³ç­–" AND "API"
   - è¯­ä¹‰åŒ¹é…ï¼šæ‰¾åˆ°ç›¸å…³çš„å†³ç­–è®°å½•
3. åŠ æƒæ’åºç»“æœ
4. è¿”å›æœ€ç›¸å…³çš„è®°å½•

## æœç´¢æµç¨‹

```
ç”¨æˆ·æŸ¥è¯¢
    â†“
è¯†åˆ«æœç´¢æ¨¡å¼ï¼ˆå…³é”®è¯/è¯­ä¹‰/æ··åˆï¼‰
    â†“
æå–æŸ¥è¯¢è¦ç´ 
    â†“
æ‰§è¡Œæœç´¢
    â†“
ç»“æœæ’åºå’Œè¿‡æ»¤
    â†“
æ ¼å¼åŒ–è¾“å‡º
    â†“
æä¾›æ“ä½œé€‰é¡¹
```

## æœç´¢æ¨¡å¼

### 1. å…³é”®è¯æœç´¢

#### å®ç°æ–¹å¼
```python
def keyword_search(query, database):
    results = []

    for record in database:
        score = 0
        # æ ‡é¢˜åŒ¹é…æƒé‡æœ€é«˜
        if query.lower() in record.title.lower():
            score += 10
        # å†…å®¹åŒ¹é…
        if query.lower() in record.content.lower():
            score += 5
        # æ ‡ç­¾åŒ¹é…
        for tag in record.tags:
            if query.lower() in tag.lower():
                score += 3

        if score > 0:
            results.append((record, score))

    # æŒ‰åˆ†æ•°æ’åº
    return sorted(results, key=lambda x: x[1], reverse=True)
```

#### æŸ¥è¯¢ç¤ºä¾‹
```
è¾“å…¥: "PostgreSQL"
åŒ¹é…:
  âœ… æ ‡é¢˜: "æ•°æ®åº“é€‰æ‹© - PostgreSQL" (10 åˆ†)
  âœ… å†…å®¹: "æˆ‘ä»¬é€‰æ‹©äº† PostgreSQL" (5 åˆ†)
  âœ… æ ‡ç­¾: "#æŠ€æœ¯/æ•°æ®åº“" (3 åˆ†)
```

### 2. è¯­ä¹‰æœç´¢

#### å®ç°æ–¹å¼
```python
def semantic_search(query, database, embedding_model):
    # ç”ŸæˆæŸ¥è¯¢å‘é‡
    query_vector = embedding_model.embed(query)

    results = []
    for record in database:
        # è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦
        similarity = cosine_similarity(
            query_vector,
            record.embedding
        )

        if similarity > threshold:  # ä¾‹å¦‚ 0.7
            results.append((record, similarity))

    return sorted(results, key=lambda x: x[1], reverse=True)
```

#### æŸ¥è¯¢ç¤ºä¾‹
```
è¾“å…¥: "æˆ‘ä»¬ä¹‹å‰è®¨è®ºè¿‡æ•°æ®åº“é€‰æ‹©å—ï¼Ÿ"
åŒ¹é…:
  âœ… æ ‡é¢˜: "æ•°æ®åº“é€‰æ‹© - PostgreSQL" (ç›¸ä¼¼åº¦: 0.89)
  âœ… å†…å®¹: "è®¨è®ºäº† PostgreSQL vs MySQL" (ç›¸ä¼¼åº¦: 0.82)
  âœ… æ ‡é¢˜: "æŠ€æœ¯é€‰å‹ - Redis ç¼“å­˜" (ç›¸ä¼¼åº¦: 0.75)
```

### 3. æ··åˆæœç´¢

#### å®ç°æ–¹å¼
```python
def hybrid_search(query, database):
    # åˆ†è¯
    keywords = extract_keywords(query)

    results = {}
    for record in database:
        total_score = 0

        # å…³é”®è¯å¾—åˆ†ï¼ˆæƒé‡ 0.3ï¼‰
        keyword_score = 0
        for keyword in keywords:
            if keyword in record.title:
                keyword_score += 10
            elif keyword in record.content:
                keyword_score += 5
        total_score += 0.3 * (keyword_score / len(keywords))

        # è¯­ä¹‰å¾—åˆ†ï¼ˆæƒé‡ 0.7ï¼‰
        semantic_score = semantic_similarity(query, record)
        total_score += 0.7 * semantic_score

        results[record] = total_score

    return sorted(results, key=lambda x: x[1], reverse=True)
```

#### æŸ¥è¯¢ç¤ºä¾‹
```
è¾“å…¥: "æ‰¾åˆ°æŠ€æœ¯å†³ç­–ï¼Œç‰¹åˆ«æ˜¯å…³äº API çš„"
å…³é”®è¯æå–: ["æŠ€æœ¯å†³ç­–", "API"]
ç»“æœ:
  1. æ ‡é¢˜: "API è®¾è®¡ - REST é€‰æ‹©" (æ€»åˆ†: 8.5)
     - å…³é”®è¯åˆ†: 3.0
     - è¯­ä¹‰åˆ†: 0.85
  2. æ ‡é¢˜: "æ•°æ®åº“é€‰æ‹© - PostgreSQL" (æ€»åˆ†: 6.2)
     - å…³é”®è¯åˆ†: 1.5
     - è¯­ä¹‰åˆ†: 0.73
```

## æœç´¢å‘½ä»¤

### å‘½ä»¤ 1: å…³é”®è¯æœç´¢
```
/search [å…³é”®è¯]
```
**ç¤ºä¾‹**:
```
/search PostgreSQL
/search æ•°æ®åº“é€‰æ‹©
```

### å‘½ä»¤ 2: è¯­ä¹‰æœç´¢
```
/semantic [æŸ¥è¯¢è¯­å¥]
```
**ç¤ºä¾‹**:
```
/semantic æˆ‘ä»¬ä¹‹å‰è®¨è®ºè¿‡æ•°æ®åº“é€‰æ‹©å—ï¼Ÿ
/semantic é‡è¦çš„æŠ€æœ¯å†³ç­–æœ‰å“ªäº›ï¼Ÿ
```

### å‘½ä»¤ 3: æ··åˆæœç´¢
```
/find [æŸ¥è¯¢]
```
**ç¤ºä¾‹**:
```
/find API ç›¸å…³çš„æŠ€æœ¯å†³ç­–
/find æœ¬å‘¨çš„é‡è¦äº‹é¡¹
```

### å‘½ä»¤ 4: æŒ‰ç±»å‹æœç´¢
```
/list [ç±»å‹]
```
**ç¤ºä¾‹**:
```
/list å†³ç­–
/list ä¼šè®®
```

### å‘½ä»¤ 5: æŒ‰é¡¹ç›®æœç´¢
```
/project [é¡¹ç›®å]
```
**ç¤ºä¾‹**:
```
/project Acme Dashboard
/project API Gateway
```

## æœç´¢è¿‡æ»¤å™¨

### æ—¥æœŸè¿‡æ»¤
```
- /today - ä»Šå¤©çš„è®°å½•
- /this-week - æœ¬å‘¨çš„è®°å½•
- /this-month - æœ¬æœˆçš„è®°å½•
- /before 2026-01-01 - æŸæ—¥æœŸä¹‹å‰
- /after 2026-01-01 - æŸæ—¥æœŸä¹‹å
```

### ç±»å‹è¿‡æ»¤
```
- /type decision - ä»…å†³ç­–
- /type daily-log - ä»…æ¯æ—¥æ—¥å¿—
- /type meeting - ä»…ä¼šè®®è®°å½•
```

### é‡è¦ç¨‹åº¦è¿‡æ»¤
```
- /important 4åŠä»¥ä¸Š
- /urgent 5æ˜Ÿ
```

### çŠ¶æ€è¿‡æ»¤
```
- /pending - è¿›è¡Œä¸­
- /completed - å·²å®Œæˆ
```

## è¾“å‡ºæ ¼å¼

### ç®€æ´è¾“å‡º
```
ğŸ” æ‰¾åˆ° 3 æ¡ç›¸å…³è®°å½•

[1] â­â­â­â­ æ•°æ®åº“é€‰æ‹© - PostgreSQL
    ğŸ“… 2026-01-15 | ğŸ·ï¸ #æŠ€æœ¯ #å†³ç­–
    å†³ç­–: é€‰æ‹© PostgreSQL ä½œä¸ºæ•°æ®åº“...

[2] â­â­â­ API è®¾è®¡ - REST é€‰æ‹©
    ğŸ“… 2026-01-20 | ğŸ·ï¸ #æŠ€æœ¯ #å†³ç­–
    å†³ç­–: é€‰æ‹© REST API...

[3] â­â­ æŠ€æœ¯é€‰å‹ - Redis ç¼“å­˜
    ğŸ“… 2026-01-25 | ğŸ·ï¸ #æŠ€æœ¯
    è®¨è®º: è€ƒè™‘ä½¿ç”¨ Redis...
```

### è¯¦ç»†è¾“å‡º
```
ğŸ” æœç´¢ç»“æœï¼ˆå…± 3 æ¡ï¼‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

[1] æ•°æ®åº“é€‰æ‹© - PostgreSQL
    ğŸ“ æ–‡ä»¶: memory/2026-01-15.md
    ğŸ“… æ—¥æœŸ: 2026-01-15 | â° æ—¶é—´: 14:30
    ğŸ·ï¸ ç±»å‹: å†³ç­– | â­ é‡è¦ç¨‹åº¦: 4â­
    ğŸ”— é¡¹ç›®: Acme Dashboard | ğŸ“Š çŠ¶æ€: å·²å®Œæˆ

    å†…å®¹ï¼š
    è®¨è®ºå¹¶é€‰æ‹©äº† PostgreSQL ä½œä¸ºæ•°æ®åº“ã€‚
    ç†ç”±: ACID ç‰¹æ€§ã€JSON æ”¯æŒã€æˆç†Ÿç¤¾åŒº
    å½±å“: æ‰€æœ‰åç«¯æœåŠ¡

    æŸ¥çœ‹å®Œæ•´è®°å½•: [[memory/2026-01-15.md]]

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

[æ“ä½œé€‰é¡¹]:
- [1] æŸ¥çœ‹è®°å½• 1
- [2] æŸ¥çœ‹è®°å½• 2
- [3] æŸ¥çœ‹è®°å½• 3
- [4] ä¼˜åŒ–æœç´¢æ¡ä»¶
- [q] é€€å‡º
```

### æ— ç»“æœè¾“å‡º
```
ğŸ” æœªæ‰¾åˆ°ç›¸å…³è®°å½•

å»ºè®®:
- å°è¯•ä¸åŒçš„å…³é”®è¯
- ä½¿ç”¨è¯­ä¹‰æœç´¢: /semantic [æŸ¥è¯¢]
- æ‰©å¤§æ—¶é—´èŒƒå›´
- æœç´¢ç›¸å…³é¡¹ç›®: /project [é¡¹ç›®å]
```

## ç»“æœæ’åº

### æ’åºé€‰é¡¹
```python
æ’åºè§„åˆ™ = {
    "relevance": "ç›¸å…³æ€§ï¼ˆé»˜è®¤ï¼‰",
    "date_desc": "æ—¥æœŸé™åº",
    "date_asc": "æ—¥æœŸå‡åº",
    "importance_desc": "é‡è¦ç¨‹åº¦é™åº",
    "importance_asc": "é‡è¦ç¨‹åº¦å‡åº"
}
```

### å‘½ä»¤
```
/sort relevance
/sort date_desc
/sort importance_desc
```

## æœç´¢ä¼˜åŒ–

### æ€§èƒ½ä¼˜åŒ–
```python
# ä½¿ç”¨ç´¢å¼•
build_index(database)

# ç¼“å­˜å¸¸ç”¨æŸ¥è¯¢
cache_results(query, results)

# é™åˆ¶ç»“æœæ•°é‡
limit_results(results, max=10)
```

### ç»“æœä¼˜åŒ–
```python
# å»é‡
deduplicate_results(results)

# æ™ºèƒ½é«˜äº®
highlight_matches(query, results)

# æä¾›æ‘˜è¦
generate_snippet(record, query)
```

## äº¤äº’æµç¨‹

### æµç¨‹ 1: ç®€å•æœç´¢
```
ç”¨æˆ·: /search PostgreSQL
AI: ğŸ” æœç´¢ "PostgreSQL"...

    æ‰¾åˆ° 3 æ¡ç›¸å…³è®°å½•

    [1] â­â­â­â­ æ•°æ®åº“é€‰æ‹© - PostgreSQL
        ğŸ“… 2026-01-15 | ğŸ·ï¸ #æŠ€æœ¯ #å†³ç­–

    [2] â­â­ æŠ€æœ¯é€‰å‹ - Redis
        ğŸ“… 2026-01-25 | ğŸ·ï¸ #æŠ€æœ¯

    ç”¨æˆ·: 1
    AI: âœ“ æ‰“å¼€è®°å½•: [[memory/2026-01-15.md]]
```

### æµç¨‹ 2: è¯­ä¹‰æœç´¢
```
ç”¨æˆ·: /semantic æˆ‘ä»¬ä¹‹å‰è®¨è®ºè¿‡æ•°æ®åº“é€‰æ‹©å—ï¼Ÿ
AI: ğŸ” è¯­ä¹‰æœç´¢...

    æ‰¾åˆ° 2 æ¡ç›¸å…³è®°å½•

    [1] â­â­â­â­ æ•°æ®åº“é€‰æ‹© - PostgreSQL
        ğŸ“… 2026-01-15
        ç›¸å…³åº¦: 89%

    [2] â­â­â­ API è®¾è®¡ - REST é€‰æ‹©
        ğŸ“… 2026-01-20
        ç›¸å…³åº¦: 75%

    ç”¨æˆ·: 1
    AI: âœ“ æ˜¾ç¤ºè¯¦ç»†è®°å½•...

        æ ‡é¢˜: æ•°æ®åº“é€‰æ‹© - PostgreSQL
        å†…å®¹: è®¨è®ºå¹¶é€‰æ‹©äº† PostgreSQL...
        ç†ç”±: ACID ç‰¹æ€§ã€JSON æ”¯æŒ...
```

### æµç¨‹ 3: æ··åˆæœç´¢ä¼˜åŒ–
```
ç”¨æˆ·: /find API ç›¸å…³çš„æŠ€æœ¯å†³ç­–
AI: ğŸ” æ··åˆæœç´¢...

    æ‰¾åˆ° 5 æ¡è®°å½•

    [1] API è®¾è®¡ - REST é€‰æ‹© (8.5åˆ†)
    [2] æ•°æ®åº“é€‰æ‹© - PostgreSQL (6.2åˆ†)
    [3] ç¼“å­˜æ–¹æ¡ˆ - Redis (5.8åˆ†)
    [4] è®¤è¯æ–¹æ¡ˆ - JWT (5.1åˆ†)
    [5] å‰ç«¯æ¡†æ¶ - React (4.3åˆ†)

    æœç´¢å¤ªå®½æ³›ï¼Ÿä½¿ç”¨è¿‡æ»¤å™¨:
    - /this-week - ä»…æœ¬å‘¨
    - /type decision - ä»…å†³ç­–
    - /important 4åŠä»¥ä¸Š - ä»…é‡è¦

    ç”¨æˆ·: /type decision
    AI: ğŸ” é‡æ–°æœç´¢ï¼ˆä»…å†³ç­–ï¼‰...

        [1] API è®¾è®¡ - REST é€‰æ‹© (8.5åˆ†)
        [2] è®¤è¯æ–¹æ¡ˆ - JWT (5.1åˆ†)
```

## é…ç½®é€‰é¡¹

```json
{
  "default_search_mode": "hybrid",
  "max_results": 10,
  "similarity_threshold": 0.7,
  "highlight_matches": true,
  "show_snippets": true,
  "enable_cache": true,
  "cache_ttl": 300
}
```

## æ‰©å±•åŠŸèƒ½

### åŠŸèƒ½ 1: æœç´¢å†å²
ä¿å­˜ç”¨æˆ·çš„æœç´¢å†å²ï¼Œæ–¹ä¾¿é‡å¤æŸ¥è¯¢

### åŠŸèƒ½ 2: æ™ºèƒ½æ¨è
åŸºäºå½“å‰æœç´¢ï¼Œæ¨èç›¸å…³è®°å½•

### åŠŸèƒ½ 3: å¯¼å‡ºç»“æœ
æ”¯æŒå¯¼å‡ºæœç´¢ç»“æœä¸º Markdownã€CSV ç­‰

### åŠŸèƒ½ 4: è¯­éŸ³æœç´¢
æ”¯æŒè¯­éŸ³è¾“å…¥æŸ¥è¯¢

## ä¸è®°å¿†ç³»ç»Ÿé›†æˆ

### æ•°æ®æº
- è¯»å–è®°å¿†æ•°æ®åº“é…ç½®
- è®¿é—® memory/ æ–‡ä»¶å¤¹
- è®¿é—® MEMORY.md

### ç´¢å¼•æ„å»º
```python
# é¦–æ¬¡ä½¿ç”¨æ—¶æ„å»ºç´¢å¼•
if not index_exists():
    build_index()

# ç›‘æ§æ–‡ä»¶å˜åŒ–
watch_files():
    update_index()
```

### åµŒå…¥å‘é‡
```python
# ç”ŸæˆåµŒå…¥å‘é‡
for record in database:
    record.embedding = embedding_model.embed(
        record.title + " " + record.content
    )

# å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“
save_embeddings(record.embedding)
```
